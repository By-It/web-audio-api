<!DOCTYPE html>
<html>
<head>
  <title>Tonematrix</title>
  <link rel="stylesheet" href="style.css">
  <script src="audio.js"></script>
  <script src="midi.js"></script>
  <script src="delay.js"></script>
  <script src="groove.js"></script>
  <script src="drummachine.js"></script>
  <script src="tonematrix.js"></script>
  <script>
    window.onload = function ()
    {
      document.getElementById( "transport" ).addEventListener("change", function(e){
         if( e.target.checked)
         {
           timeInfo.position = 0.0;
           timeInfo.transporting = true;
         }
         else
         {
           timeInfo.transporting = false;
         }
       });
      document.getElementById( "buffer-size" ).innerHTML = bufferSize;
      document.getElementById( "sample-rate" ).innerHTML = sampleRate;
      var bpmInput = document.getElementById( "bpm-input" );
      var bpmOutput = document.getElementById( "bpm-output" );
      var bpmUpdate = function ()
      {
        bpmOutput.innerHTML = timeInfo.bpm = bpmInput.value;
      };
      bpmInput.addEventListener( "input", bpmUpdate );
      bpmInput.value = timeInfo.bpm;
      bpmUpdate();
      var midiInputs = document.getElementById( "midi-inputs" );
      Midi.onInit = function ( inputs )
      {
        inputs.forEach( function ( entry, index, array )
        {
          var node = document.createElement( "li" );
          var textnode = document.createTextNode( entry.name );
          node.appendChild( textnode );
          midiInputs.appendChild( node );
        } );
      }
    }
  </script>
</head>
<body>
<h1>Minimal Audio</h1>
<input type="checkbox" id="transport" value="false">Playing<br>
BufferSize: <span id="buffer-size"></span>
<br>SampleRate: <span id="sample-rate"></span>
<br>
<input type="range" id="bpm-input" min="60" max="300" value="120"><span id="bpm-output"></span>
<ul id="midi-inputs"></ul>
</body>
</html>